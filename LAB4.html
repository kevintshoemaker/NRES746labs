<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="NRES 746" />


<meta name="progressive" content="false" />
<meta name="allow-skip" content="false" />
<meta name="learnr-version-prerender" content="0.11.4" />

<title>Lab 4</title>

<!-- header-includes START -->
<!-- HEAD_CONTENT -->
<!-- header-includes END -->
<!-- HEAD_CONTENT -->

<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>


<!-- taken from https://github.com/rstudio/rmarkdown/blob/de8a9c38618903627ca509f5401d50a0876079f7/inst/rmd/h/default.html#L293-L343 -->
<!-- tabsets -->
<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>
<!-- end tabsets -->


</head>

<body>
<a class='sr-only sr-only-focusable visually-hidden-focusable' href='#learnr-tutorial-content'>Skip to Tutorial Content</a>



<div class="pageContent band">
<main class="bandContent page">

<article class="topics" id="learnr-tutorial-content">

<div id="section-lab-4-bayesian-inference" class="section level2">
<h2>Lab 4: Bayesian inference</h2>
<p>As with all lab reports, your answers will either take the form of R
functions or short written responses (submitted together in a Word
document). The R functions should be stored in an R script file (‘.R’
extension) using the same file naming convention we have used for
previous labs (“first_last_lab4.R”).</p>
<p>Please submit the R script using the shared Box folder and submit the
Word document via WebCampus by midnight on the due date. You’re welcome
to work in groups but please submit the materials individually.</p>
<p>First, take a little time to review the <a
href="https://kevintshoemaker.github.io/NRES-746/LECTURE6.html">Bayesian
inference lecture</a> and <a
href="https://kevintshoemaker.github.io/NRES-746/LECTURE7.html">MCMC
lecture</a>!</p>
<p><strong>Lab 4 is due before midnight on Friday November
17</strong></p>
</div>
<div id="section-bayesian-inference-with-bugs" class="section level2">
<h2>Bayesian inference (with BUGS!)</h2>
<p>If you haven’t already installed JAGS on your computer, use <a
href="http://mcmc-jags.sourceforge.net/">this link</a>. You need to
install JAGS on your computer – loading R packages like ‘jagsUI’ is not
enough.</p>
<p>In this lab we will be applying a Bayesian approach to model fitting
using the same myxomatosis dataset and data generating model that we
used in the previous lab (lab 3: maximum likelihood inference). To do
this, we’ll be using the program JAGS (<strong>J</strong>ust
<strong>A</strong>nother <strong>G</strong>ibbs
<strong>S</strong>ampler).</p>
<p>JAGS runs on all platforms and runs seamlessly with R, if you
download the “jagsUI” package! JAGS is not the only way to do Bayesian
analyses, nor is it the only implementation of the BUGS (Bayesian
inference Using Gibbs Sampler) language. Others that you may have heard
of include WinBUGS, OpenBUGS and NIMBLE (R package). STAN is another
widely used software for Bayesian inference, but STAN doesn’t use the
BUGS language (it has its own language!)</p>
<p>To familiarize ourselves with the BUGS language, let’s look at some
BUGS code (for our favorite myxomatosis dataset).</p>
<pre><code>
#############
# sample BUGS code       

model {
      
      #############
      # LIKELIHOOD
      ############
      for(obs in 1:n.observations){
        titer[obs] ~ dgamma(shape,rate)
      }
      
      #############
      # PRIORS
      ############
      shape ~ dgamma(0.001,0.001)
      scale ~ dgamma(0.001,0.001)
      rate &lt;- 1/scale   # in BUGS, gamma distribution needs a &quot;rate&quot; parameter rather than a scale 
    }
    </code></pre>
<p>The syntax in BUGS/JAGS is very similar to R, but there are a few key
differences. Notably, <em>assignment must always be done by the arrow
(&lt;-) instead of an equals sign</em> and the <em>tilde (~) is used to
define stochastic processes</em>.</p>
<p>The arrow operator (&lt;-) is used to define deterministic
relationships, and can be read as “is defined as:”</p>
<p>The tilde operator (~) is used to define random variables, and can be
read as “is distributed as:”</p>
<p>In the model code, you must also specify your priors. Here we are
using ‘vague’ priors, meaning that the probability is ‘spread out’
fairly evenly over a wide parameter space. The Gamma distribution is
always parameterized according to a shape and rate parameter (in that
order) in BUGS (rate = 1/scale). If you wanted to see what this
distribution looked like, you could plot in R (‘dgamma()’ allows you to
specify a rate or a scale parameter):</p>
<pre class="r"><code>par(mfrow=c(2,1))
curve(dgamma(x, shape=0.001, rate=0.001),0,100,ylim=c(0,0.1),xlab=&quot;shape parameter&quot;,ylab=&quot;probability density&quot;, main=&quot;Prior&quot;)
curve(dgamma(x, shape=0.001, rate=0.001),0.01,0.5,ylim=c(0,1),xlab=&quot;scale parameter&quot;,ylab=&quot;probability density&quot;)</code></pre>
<p><img src="LAB4_files/figure-html/unnamed-chunk-2-1.png" width="480" /></p>
<p>In this case we want a prior distribution that has little to no
information about which values of the parameter are most probable. These
distributions have no peaks within the range of parameter space of
interest, and the probability for any particular x-value is very low, so
it does a fairly good job of representing a vague prior for the shape
and rate parameters.</p>
</div>
<div id="section-running-jags-through-r" class="section level2">
<h2>Running JAGS through R</h2>
<p><strong>Setting up the model!</strong></p>
<p>We can use the ‘jagsUI’ package in R (or runjags, or R2jags: there
are several packages available that do basically the same thing) to run
JAGS through R and have the output returned to R so that we can analyze
and manipulate it further.</p>
<p>First, let’s install and load the ‘jagsUI’ package. While you’re at
it, install and load the coda package, which has some great utilities
for visualizing and working with MCMC data.</p>
<pre class="r"><code>### load key packages for running Bayesian analysis in JAGS

library(jagsUI)
library(coda)</code></pre>
<pre><code>## 
## Attaching package: &#39;coda&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:jagsUI&#39;:
## 
##     traceplot</code></pre>
<pre class="r"><code>library(HDInterval)
library(emdbook)


#library(R2jags)    # alternatives
#library(runjags)</code></pre>
<p><strong>Writing out the model</strong></p>
<p>We can use the ‘cat’ function in R to write out a text file- it can
be useful to use this functionality to embed the JAGS code within our R
script!</p>
<pre class="r"><code>filename &lt;- &quot;BUGSmodel.txt&quot;
cat(&quot;
    model {
      
      #############
      # LIKELIHOOD
      ############
      for(obs in 1:n.observations){
        titer[obs] ~ dgamma(shape,rate)
      }
      
      #############
      # PRIORS
      ############
      shape ~ dgamma(0.01,0.01)
      scale ~ dgamma(0.001,0.001)
      rate &lt;- 1/scale
    }
  &quot;,file=filename
)</code></pre>
<p><strong>Bundling the data</strong></p>
<p>We will need to tell BUGS/JAGS what the data are. To be read into
JAGS (via the R2JAGS package), the data need to be bundled together in a
list object. The data (list elements) need to have the same names as
specified in the BUGS model file:</p>
<p>First we get the data we want into R (we know the drill!):</p>
<pre class="r"><code>library(emdbook)

MyxDat &lt;- MyxoTiter_sum
Myx &lt;- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
head(Myx)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["grade"],"name":[1],"type":["int"],"align":["right"]},{"label":["day"],"name":[2],"type":["int"],"align":["right"]},{"label":["titer"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"2","3":"5.207","_rn_":"1"},{"1":"1","2":"2","3":"5.734","_rn_":"2"},{"1":"1","2":"2","3":"6.613","_rn_":"3"},{"1":"1","2":"3","3":"5.997","_rn_":"4"},{"1":"1","2":"3","3":"6.612","_rn_":"5"},{"1":"1","2":"3","3":"6.810","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Then we bundle the data as a list, which is what JAGS wants!</p>
<pre class="r"><code>myx.data.for.bugs &lt;- list(
  titer = Myx$titer,
  n.observations = length(Myx$titer)
)

myx.data.for.bugs</code></pre>
<pre><code>## $titer
##  [1] 5.207 5.734 6.613 5.997 6.612 6.810 5.930 6.501 7.182 7.292 7.819 7.489
## [13] 6.918 6.808 6.235 6.916 4.196 7.682 8.189 7.707 7.597 7.112 7.354 7.158
## [25] 7.466 7.927 8.499
## 
## $n.observations
## [1] 27</code></pre>
<p><strong>Setting the initial values for our Markov
chain(s)</strong></p>
<p>It is convenient to define an “initial value generator” function that
randomly generates a list of initial values– this way, each MCMC chain
can automatically be initialized with different starting values!</p>
<pre class="r"><code>init.vals.for.bugs &lt;- function(){
  list(
    shape=runif(1,20,100),
    scale=runif(1,0.05,0.3)
  )
}
init.vals.for.bugs()</code></pre>
<pre><code>## $shape
## [1] 34.16659
## 
## $scale
## [1] 0.1057605</code></pre>
<pre class="r"><code>init.vals.for.bugs()</code></pre>
<pre><code>## $shape
## [1] 67.71099
## 
## $scale
## [1] 0.2166672</code></pre>
<p>Alternatively, we can specify exact initial values for our chains (in
this case, we initialize three Markov chains)</p>
<pre class="r"><code>inits = list(list(shape=90,scale=0.1), list(shape=50,scale=0.2), list(shape=150,scale=0.04))  # a list of lists!</code></pre>
<p>Note that we need three different sets of starting values in order to
run three different chains. Just like an optimization algorithm in ML
analysis, JAGS may not work if you specify unreasonable initial
parameters (and it won’t necessarily tell you that is the problem).</p>
<p>Now we’ll run this model through JAGS:</p>
<pre class="r"><code>params.to.store &lt;- c(&quot;shape&quot;,&quot;scale&quot;)    # specify the parameters we want to get the posteriors for

jags.fit &lt;- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file=&quot;BUGSmodel.txt&quot;,n.chains = 3,n.burnin = 5000,n.thin = 20,parallel=TRUE )</code></pre>
<pre><code>## 
## Processing function input....... 
## 
## Done. 
##  
## Beginning parallel processing using 3 cores. Console output will be suppressed.
## 
## Parallel processing completed.
## 
## Calculating statistics....... 
## 
## Done.</code></pre>
<pre class="r"><code>jags.fit</code></pre>
<pre><code>## JAGS output for model &#39;BUGSmodel.txt&#39;, generated by jagsUI.
## Estimates based on 3 chains of 50000 iterations,
## adaptation = 100 iterations (sufficient),
## burn-in = 5000 iterations and thin rate = 20,
## yielding 6750 total samples from the joint posterior. 
## MCMC ran in parallel for 0.046 minutes at time 2023-10-23 21:15:04.740873.
## 
##            mean     sd   2.5%    50%  97.5% overlap0 f  Rhat n.eff
## shape    46.121 12.887 24.355 44.984 73.868    FALSE 1 1.006   372
## scale     0.163  0.050  0.094  0.154  0.286    FALSE 1 1.020   196
## deviance 77.511  2.166 75.386 76.862 83.387    FALSE 1 1.016   282
## 
## Successful convergence based on Rhat values (all &lt; 1.1). 
## Rhat is the potential scale reduction factor (at convergence, Rhat=1). 
## For each parameter, n.eff is a crude measure of effective sample size. 
## 
## overlap0 checks if 0 falls in the parameter&#39;s 95% credible interval.
## f is the proportion of the posterior with the same sign as the mean;
## i.e., our confidence that the parameter is positive or negative.
## 
## DIC info: (pD = var(deviance)/2) 
## pD = 2.3 and DIC = 79.842 
## DIC is an estimate of expected predictive error (lower is better).</code></pre>
<p>For each parameter, n.eff is a crude measure of effective sample
size, and Rhat is the potential scale reduction factor (Gelman-Rubin
diagnostic: at convergence, Rhat=1).</p>
<p>DIC is an information criterion (Deviance Information Criterion),
similar to AIC (lower DIC is better).</p>
<p>You can see the means and variance for the parameters as well as the
DIC for the model. We can summarize these in plots of the posterior
distributions. First, we define the MCMC output as a ‘coda’ object (for
storing, visualizing and analyzing MCMC results) that R knows how to
work with.</p>
<pre class="r"><code>jagsfit.mcmc &lt;- jags.fit$samples   # retrieve results as &#39;coda&#39; object (coda package)

summary(jagsfit.mcmc)</code></pre>
<pre><code>## 
## Iterations = 5020:50000
## Thinning interval = 20 
## Number of chains = 3 
## Sample size per chain = 2250 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##             Mean       SD Naive SE Time-series SE
## shape    46.1207 12.88704  0.15686       0.686172
## scale     0.1632  0.05012  0.00061       0.002904
## deviance 77.5107  2.16650  0.02637       0.078888
## 
## 2. Quantiles for each variable:
## 
##              2.5%     25%     50%     75%   97.5%
## shape    24.35538 36.5867 44.9841 54.4300 73.8677
## scale     0.09353  0.1271  0.1542  0.1889  0.2861
## deviance 75.38645 75.9633 76.8622 78.3820 83.3872</code></pre>
<pre class="r"><code>plot(jagsfit.mcmc)</code></pre>
<p><img src="LAB4_files/figure-html/unnamed-chunk-10-1.png" width="480" /></p>
<pre class="r"><code>library(lattice)</code></pre>
<pre><code>## 
## Attaching package: &#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:jagsUI&#39;:
## 
##     densityplot</code></pre>
<pre class="r"><code>densityplot(jagsfit.mcmc)</code></pre>
<p><img src="LAB4_files/figure-html/unnamed-chunk-10-2.png" width="480" /></p>
<p>You can visually check for convergence here, using the traceplots – a
converged run will look like white noise (fuzzy caterpillar) and the
samples will not be hitting any ceilings or floors.</p>
<p><strong>Parameter uncertainty: credible intervals</strong></p>
<p>We can estimate the 95% credible interval for each parameter using
the quantile method or the HPD interval method. The ‘sims.list’ part of
the output has all of the MCMC samples that were created during the run
(combining all chains).</p>
<pre class="r"><code>## quantile method

shape95 = quantile(jags.fit$sims.list$shape,c(0.025,0.975))
scale95 = quantile(jags.fit$sims.list$scale,c(0.025,0.975))
shape95</code></pre>
<pre><code>##     2.5%    97.5% 
## 24.35538 73.86775</code></pre>
<pre class="r"><code>scale95</code></pre>
<pre><code>##       2.5%      97.5% 
## 0.09353034 0.28607075</code></pre>
<pre class="r"><code>## HPD method (highest posterior density intervals)

library(HDInterval)

shape95 = hdi(jags.fit$sims.list$shape,0.95)
scale95 = hdi(jags.fit$sims.list$scale,0.95)
shape95</code></pre>
<pre><code>##    lower    upper 
## 23.42738 72.55351 
## attr(,&quot;credMass&quot;)
## [1] 0.95</code></pre>
<pre class="r"><code>scale95</code></pre>
<pre><code>##      lower      upper 
## 0.08472909 0.26212846 
## attr(,&quot;credMass&quot;)
## [1] 0.95</code></pre>
<p>Either way we compute it, the probability that the <em>a</em>
parameter is between these 2 numbers is 95%!</p>
<p>So, what’s so great about this? Using a vague prior, we get almost
the exact same parameter estimates that we did when we just did a
straight up maximum-likelihood analysis. This is usually the case with
simple models like the run we ran here. However, answers can be quite
different with more complicated models, and in fact the Bayesian
approach allows us to simultaneously fit complex models that we could
not easily fit using maximum-likelihood approaches.</p>
<p>That said, there are several advantages to the Bayesian approach,
having to do with the fact that the answer comes in the form of a
probability distribution (or random samples from a probability
distribution) instead of a point estimate.</p>
<p>For one, the credible interval is much nicer to interpret than a
confidence interval. There’s none of this “given that the null
hypothesis is true”, and “were we to re-sample the data 100000 times…”.
You can state simply that there’s a 95% probability that the value of
the parameter lies within the credible interval. Period.</p>
<p>For another, when running simulations you can draw from posterior
probability distributions to create simulations that include the full
variability of outcomes instead of just point estimates, which will
demonstrate the implications of uncertainty in your parameter estimates
(e.g. under different management scenarios, climate change, etc.). We’ll
explore how to do this a little later.</p>
</div>
<div id="section-exercise-4.1-myxomatosis-analysis-in-jags-1"
class="section level2">
<h2>Exercise 4.1: Myxomatosis analysis in JAGS #1</h2>
<p>In this exercise, you are asked to implement a Ricker deterministic
function to the Myxomatosis data in JAGS.</p>
</div>
<div id="section-exercise-4.1a." class="section level2">
<h2><strong>Exercise 4.1a</strong>.</h2>
<p>Write a function called “Myx_Ricker_JAGS()” that runs the
Myxomatosis/Ricker example from the previous (likelihood) lab in JAGS.
Recall that we are modeling titer levels (grade 1 only) as a function of
the days since infection. Submit this function as part of your R
script.</p>
<ul>
<li><strong>input</strong>:
<ul>
<li>data = a matrix of 2 columns and one row per observation. The first
column should represent the days since infection, and the second column
should represent the virus titer.</li>
<li>CImethod = a text string, representing whether the CI should be
computed using the quantile method (“quantile”) or the HPD method
(“HPD”). See the Bayesian lecture for more information.<br />
</li>
<li>CIlevel = a number from 0 to 1 indicating what confidence level you
want for the CI: set the default value to 0.95.</li>
</ul></li>
<li><strong>suggested algorithm</strong>:
<ul>
<li>Write and store the JAGS model as a text file (you can name the file
whatever you’d like!) [NOTE: the code for writing the JAGS model as a
text file should be embedded in the function]</li>
<li>Package the data for JAGS (store all data in a named list
object)<br />
</li>
<li>Write a function that returns a list for initializing the MCMC
chains [this could be defined inside or outside the Myx_Ricker_JAGS()
function]<br />
</li>
<li>Run the ‘jags()’ function from the ‘jagsUI’ package with 3 chains,
specifying the parameters for which you wish to store the MCMC output
(“a”, “b”, and “shape”), and store the results as an R object.<br />
</li>
<li>Display the trace plots and density plots for the three parameters
(you may need to comment this part out for testing in the ‘sandbox’
below due to graphical constraints)</li>
<li>compute the posterior means for the a, b and shape params and store
as a named vector (three elements, named “a”, “b”, and “shape”, in that
order).</li>
<li>Plot the raw data (days on x axis and titer on y axis), and overlay
the fitted Ricker curve, with Bayesian point estimates (posterior means)
to evaluate fit.<br />
</li>
<li>compute the credible interval (CI) for the three parameters using
either the quantile method or the HPD method (as requested by the user),
and store as a 2x3 matrix (see below). HINT: use the ‘HDInterval’
package to help compute the HPD.<br />
</li>
<li>compute the overall Gelman-Rubin diagnostic (‘gelman.diag’ function,
quantity labeled ‘Multivariate psrf’) for all three parameters using the
JAGS raw mcmc results (e.g., ‘myjagsmodel$samples’) as input to the
‘gelman.diag()’ function).</li>
</ul></li>
<li><strong>return</strong>:
<ul>
<li>a list of length 3 containing (list element 1) a named vector of
point estimates (posterior means) for parameters a, b, and shape, (list
element 2) a matrix with 2 rows and 3 columns, containing the 95%
credible interval (row 1 is the lower bound, row 2 is the upper bound,
columns represent parameters a, b, and shape), and (list element 3) a
single number representing the ‘multivariate’ Gelman-Rubin diagnostic
(potential scale reduction factor)- a tool for assessing MCMC
convergence.</li>
</ul></li>
</ul>
<p>Include your function in your submitted r script!</p>
<p>You can use this “sandbox” (below) to develop and test your
function!</p>
<p>NOTE: you need to include code that writes out your BUGS textfile,
whether or not it is inside or outside your function. If your BUGS code
(text file) is not named “BUGSmodel_ricker.txt” you will have to change
the file name in the test code (last line in the “sandbox” below).</p>
<p>NOTE: to test your code in the “sandbox” you may need to suppress
(comment out) the part of the function that generates multi-panel plots,
or you may get the dreaded “figure margins too large” error.</p>
<div class="tutorial-exercise" data-label="q4_1a" data-completion="1"
data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>Myx_Ricker_JAGS &lt;- function(data,CImethod,CIlevel){
    # [add code here!]
}

# MyxDat &lt;- emdbook::MyxoTiter_sum
# Myx &lt;- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
# this &lt;- Myx_Ricker_JAGS(data=Myx[,-1],JAGScode = &quot;BUGSmodel_ricker.txt&quot;, CImethod = &quot;HPD&quot;, CIlevel = 0.95)
# test &lt;- this$conf.ints</code></pre>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":true,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
<p>Here is some test code, along with a sample of the results you should
expect to see when running your new function:</p>
<pre class="r"><code>Ricker_results &lt;- Myx_Ricker_JAGS(data=Myx[,-1],CImethod=&quot;HPD&quot;,CIlevel=0.88)</code></pre>
<pre><code>## 
## Processing function input....... 
## 
## Done. 
##  
## Beginning parallel processing using 3 cores. Console output will be suppressed.
## 
## Parallel processing completed.
## 
## Calculating statistics....... 
## 
## Done.</code></pre>
<p><img src="LAB4_files/figure-html/testq4_1a-1.png" width="480" /><img src="LAB4_files/figure-html/testq4_1a-2.png" width="480" /><img src="LAB4_files/figure-html/testq4_1a-3.png" width="480" /></p>
<pre class="r"><code>Ricker_results</code></pre>
<pre><code>## $post.mean
## [1]  3.5531365  0.1704293 78.3883760
## 
## $conf.ints
##             a         b     shape
## [1,] 3.225021 0.1533498  44.39682
## [2,] 3.886007 0.1879342 111.22582
## 
## $gelman.rubin
## [1] 1.002938</code></pre>
<pre class="r"><code>Ricker_results &lt;- Myx_Ricker_JAGS(data=Myx[,-1],CImethod=&quot;quantile&quot;,CIlevel=0.88)</code></pre>
<pre><code>## 
## Processing function input....... 
## 
## Done. 
##  
## Beginning parallel processing using 3 cores. Console output will be suppressed.
## 
## Parallel processing completed.
## 
## Calculating statistics....... 
## 
## Done.</code></pre>
<p><img src="LAB4_files/figure-html/testq4_1a-4.png" width="480" /><img src="LAB4_files/figure-html/testq4_1a-5.png" width="480" /><img src="LAB4_files/figure-html/testq4_1a-6.png" width="480" /></p>
<pre class="r"><code>Ricker_results</code></pre>
<pre><code>## $post.mean
## [1]  3.5550596  0.1704533 78.7146524
## 
## $conf.ints
##             a         b     shape
## [1,] 3.237050 0.1530744  47.72628
## [2,] 3.892334 0.1872045 114.82463
## 
## $gelman.rubin
## [1] 1.001526</code></pre>
</div>
<div id="section-exercise-4.1b." class="section level2">
<h2><strong>Exercise 4.1b</strong>.</h2>
<p>Can you identify any differences between the parameter estimates from
the analysis in a likelihood vs Bayesian perspective? Compare your
results from Lab 3, and briefly describe your findings in your Word
document, along with a brief description of why these differences might
arise.</p>
</div>
<div id="section-exercise-4.1c." class="section level2">
<h2><strong>Exercise 4.1c</strong>.</h2>
<p>Did your MCMC chains converge on the joint posterior distribution?
Briefly explain your reasoning in your Word document! Use several lines
of reasoning, and provide figures where appropriate!</p>
</div>
<div
id="section-exercise-4.2-myxomatosis-in-jags-with-michaelis-menten-deterministic-function"
class="section level2">
<h2>Exercise 4.2: Myxomatosis in JAGS with Michaelis-Menten
deterministic function</h2>
<p>Recalling our plot (from the last lab) of the Ricker function with
the maximum-likelihood parameter estimates drawn over the scatterplot of
titers by day, there really isn’t much evidence in the data for that
downward turn in the function after day 6. We chose a model that
indicated decline in titer levels following a peak based on the behavior
of other myxomytosis grades, but given the virulence of this particular
grade most animals die once the titer levels reach their maximum. Might
it be more appropriate to fit a model (titer as a function of days since
exposure) that levels off at some asymptote instead of declining
following the peak? Let’s find out!</p>
</div>
<div id="section-exercise-4.2a." class="section level2">
<h2><strong>Exercise 4.2a</strong>.</h2>
<p>Repeat the myxomatosis example in BUGS/JAGS, but this time use the
<strong>Michaelis-Menten function</strong>, which has the same number of
parameters as the Ricker function, but increases to an asymptote (see
below). Continue to use a Gamma distribution to describe the error!
Please name your new function “Myx_MM_JAGS()”. The inputs and outputs
should be the same as for “Myx_Ricker_JAGS()”. Please save this new
function in your R script for submission.</p>
<p>The M-M function looks like this:</p>
<p><span class="math inline">\(\frac{a\cdot x}{b+x}\)</span></p>
<pre class="r"><code>mm = function(x,a,b) { a*x / (b+x) }</code></pre>
<p>You can plot an M-M function over the points to get some initial
parameter estimates.</p>
<pre class="r"><code>plot(Myx$titer~Myx$day,xlim=c(0,10),ylim=c(0,10))
curve(mm(x,a=5,b=0.8),from=0,to=10,add=T,col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="LAB4_files/figure-html/unnamed-chunk-13-1.png" width="624" /></p>
<p>Include your function in your submitted r script!</p>
<p>You can use this “sandbox” (below) to develop and test your
function!</p>
<p>NOTE: you need to include code that writes out your BUGS textfile,
whether or not it is inside or outside your function. If your BUGS code
(text file) is not named “BUGSmodel_mm.txt” you will have to change the
file name in the test code (last line in the “sandbox” below).</p>
<p>NOTE: to test your code in the “sandbox” you may need to suppress
(comment out) the part of the function that generates multi-panel plots,
or you may get the dreaded “figure margins too large” error.</p>
<div class="tutorial-exercise" data-label="q4_2a" data-completion="1"
data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>Myx_MM_JAGS &lt;- function(data,CImethod,CIlevel){
    # [add code here!]
}

# MyxDat &lt;- emdbook::MyxoTiter_sum
# Myx &lt;- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
# this &lt;- Myx_MM_JAGS(data=Myx[,-1], CImethod = &quot;HPD&quot;, CIlevel = 0.95)
# test &lt;- this$conf.ints</code></pre>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":true,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
<p>And here are some test commands with output:</p>
<pre class="r"><code>MM_results &lt;- Myx_MM_JAGS(data=Myx[,-1],CImethod=&quot;HPD&quot;,CIlevel=0.88)</code></pre>
<pre><code>## 
## Processing function input....... 
## 
## Done. 
##  
## Beginning parallel processing using 3 cores. Console output will be suppressed.
## 
## Parallel processing completed.
## 
## Calculating statistics....... 
## 
## Done.</code></pre>
<p><img src="LAB4_files/figure-html/test4.2a-1.png" width="480" /><img src="LAB4_files/figure-html/test4.2a-2.png" width="480" /><img src="LAB4_files/figure-html/test4.2a-3.png" width="480" /></p>
<pre class="r"><code>MM_results</code></pre>
<pre><code>## $post.mean
## [1]  8.836062  1.194889 98.935153
## 
## $conf.ints
##             a         b     shape
## [1,] 8.032456 0.7192388  57.32358
## [2,] 9.637595 1.6659408 142.58910
## 
## $gelman.rubin
## [1] 1.001616</code></pre>
<pre class="r"><code>MM_results &lt;- Myx_MM_JAGS(data=Myx[,-1],CImethod=&quot;quantile&quot;,CIlevel=0.88)</code></pre>
<pre><code>## 
## Processing function input....... 
## 
## Done. 
##  
## Beginning parallel processing using 3 cores. Console output will be suppressed.
## 
## Parallel processing completed.
## 
## Calculating statistics....... 
## 
## Done.</code></pre>
<p><img src="LAB4_files/figure-html/test4.2a-4.png" width="480" /><img src="LAB4_files/figure-html/test4.2a-5.png" width="480" /><img src="LAB4_files/figure-html/test4.2a-6.png" width="480" /></p>
<pre class="r"><code>MM_results</code></pre>
<pre><code>## $post.mean
## [1]  8.838273  1.198426 98.598502
## 
## $conf.ints
##             a         b     shape
## [1,] 8.074538 0.7487607  58.50656
## [2,] 9.694351 1.7011249 144.70866
## 
## $gelman.rubin
## [1] 1.002286</code></pre>
</div>
<div id="section-exercise-4.2b." class="section level2">
<h2><strong>Exercise 4.2b</strong>.</h2>
<p>In your Word document, please answer the following question: overlay
both the best-fit M-M and the best-fit Ricker curves on a plot of the
data (please include this figure in your Word document). On the basis of
simple visual cues, does the M-M function seem to fit better than the
Ricker function to describe this relationship? Explain your
reasoning.</p>
<p>And here is an example of what your figure should look like with the
best-fit M-M and Ricker functions overlaid on the same plot:</p>
<p><img src="LAB4_files/figure-html/answer4.2b-1.png" width="624" /></p>
</div>
<div id="section-exercise-4.3.-goodness-of-fit-and-model-comparison"
class="section level2">
<h2>Exercise 4.3. Goodness-of-fit and model comparison</h2>
<p>Let’s try a different approach for visualizing the goodness-of-fit of
these two models. For each of these models, follow the instructions
provided below to evaluate goodness-of-fit. On the basis of a
<em>posterior predictive check</em> (see below), how well would you say
each model fits the observed data? Do you see any red flags that would
indicate poor goodness-of-fit?</p>
</div>
<div id="section-exercise-4.3a." class="section level2">
<h2><strong>Exercise 4.3a</strong>.</h2>
<p>Write a function called “Myx_PostPredCheck()” that compares the
goodness-of-fit for the two models (ricker vs M-M) using a posterior
predictive check.</p>
<ul>
<li><strong>input</strong>:
<ul>
<li>MCMC1 = the object generated from running the ‘jags()’ function with
the Ricker function.<br />
</li>
<li>MCMC2 = the object generated from running the ‘jags()’ function with
the Michaelis-Menten function.</li>
</ul></li>
<li><strong>suggested algorithm</strong>:
<ul>
<li>For each model (Ricker, M-M), generate new data under the fitted
model. For each of an arbitrarily large number (e.g., 1000) of
replicates, sample from the joint posterior distribution:
<ul>
<li><p>pick a random integer between 1 and the number of MCMC samples
(e.g., call that number “random_index”)<br />
</p></li>
<li><p>Then, use that random index to draw a single sample from the
joint posterior distribution for the parameters “a”, “b”, and “shape”.
This could look something like this:
<code>new.draw &lt;- jags.fit$sims.list$a[random_index]</code> (for the
‘a’ parameter).<br />
</p></li>
<li><p>Using those parameters you just drew from the joint posterior
distribution (i.e., assuming the “a”, “b”, and “shape” parameters you
just drew are the ‘true’ parameters), simulate a new data set with the
same number of observations as your original dataset (For each real
observation, generate a single simulated observation under the data
generating model)</p></li>
<li><p>For each simulated data point, compute the squared residual
error- that is, the squared difference between the simulated data point
and the expected value from the Ricker or M-M model.</p></li>
<li><p>For each observed data point, compute the squared residual error-
that is, the squared difference between the observed data point and the
expected value from the Ricker or M-M model.</p></li>
<li><p>Compute and store the sum of squared errors across all
observations (SSE) for both the observed data (SSE_obs) and the
simulated data (SSE_sim) corresponding to each sample from the joint
posterior distribution.<br />
</p></li>
</ul></li>
<li>For each model (Ricker, M-M), use the ‘boxplot()’ function to
display the range of plausible data that could be generated under the
fitted model (using the simulated data). Overlay the observed data. This
provides a visual goodness-of-fit evaluation (visual <em>Posterior
Predictive Check</em>).</li>
<li>Plot the sum of squared error for the simulated data sets (Y axis)
against the sum of squared error for the actual data set. Overlay a 1:1
line (that is, the line corresponding to y=x). This is another type of
visual <em>Posterior Predictive Check</em>.</li>
<li>Compute the proportion of the simulated error metrics (SSE_sim,
computed from the simulated data) that are larger than the analogous
discrepancy metric computed from the observed data (SSE_obs). This
quantity is often called a <em>Bayesian p-value</em> (but note that this
is interpreted very differently than a frequentist p-value, and can
therefore be a bit of a confusing term!).</li>
</ul></li>
<li><strong>return</strong>:
<ul>
<li>a list of length 3 containing (1) a vector of length 2 storing the
Bayesian p-values for the two models (Ricker first, then M-M), computed
above, (2) a data frame with number of rows equal to the number of
simulation replicates (e.g., 1000) and five columns: the first three
indicating the sampled parameter values drawn from the joint posterior
for the Ricker model (“a”, “b”, and “shape”), followed by the
corresponding SSE_sim (sum of squared error computed from simulated
data) and SSE_obs (sum of squared error computed from observed data)
[NOTE: the last two columns are the data used to compute the Bayesian
p-value), and (3) an analogous data frame for the M-M model.</li>
</ul></li>
</ul>
<p>Include your function in your submitted r script!</p>
<p>You can use this “sandbox” (below) to develop and test your
function!</p>
<p>NOTE: the objects “jags.fit_ricker” and “jags.fit_mm” are available
in the “sandbox” below for testing your function.</p>
<div class="tutorial-exercise" data-label="q4_3a" data-completion="1"
data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>Myx_PostPredCheck &lt;- function(MCMC1,MCMC2){
    # [add code here!]
}

# Myx_PostPredCheck(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)</code></pre>
<script type="application/json" data-ui-opts="1">{"engine":"r","has_checker":true,"caption":"<span data-i18n=\"text.enginecap\" data-i18n-opts=\"{&quot;engine&quot;:&quot;R&quot;}\">R Code<\/span>"}</script>
</div>
<pre><code>## 
## Processing function input....... 
## 
## Done. 
##  
## Beginning parallel processing using 3 cores. Console output will be suppressed.
## 
## Parallel processing completed.
## 
## Calculating statistics....... 
## 
## Done.</code></pre>
<pre><code>## 
## Processing function input....... 
## 
## Done. 
##  
## Beginning parallel processing using 3 cores. Console output will be suppressed.
## 
## Parallel processing completed.
## 
## Calculating statistics....... 
## 
## Done.</code></pre>
<p>And here is what the results of your function should look like!</p>
<pre class="r"><code>####
# Test the function

test &lt;- Myx_PostPredCheck(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)</code></pre>
<p><img src="LAB4_files/figure-html/testq4_3a-1.png" width="624" /><img src="LAB4_files/figure-html/testq4_3a-2.png" width="624" /><img src="LAB4_files/figure-html/testq4_3a-3.png" width="624" /><img src="LAB4_files/figure-html/testq4_3a-4.png" width="624" /></p>
<pre class="r"><code>test[[1]]   # p-vals</code></pre>
<pre><code>## [1] 0.712 0.739</code></pre>
<pre class="r"><code>head(test[[2]])    # ppc for ricker</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["a"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["b"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["shape"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SSEsim"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SSEobs"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"3.326664","2":"0.1561485","3":"68.39375","4":"17.51932","5":"13.12433","_rn_":"1"},{"1":"3.418545","2":"0.1612667","3":"97.23329","4":"14.58625","5":"12.80781","_rn_":"2"},{"1":"3.606265","2":"0.1706644","3":"70.44458","4":"21.35877","5":"13.03692","_rn_":"3"},{"1":"3.478489","2":"0.1628565","3":"85.41298","4":"11.37602","5":"13.38330","_rn_":"4"},{"1":"3.723402","2":"0.1792455","3":"71.52936","4":"10.65752","5":"13.08304","_rn_":"5"},{"1":"3.392387","2":"0.1638222","3":"73.67864","4":"22.43186","5":"12.12968","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>head(test[[3]])    # ppc for M-M</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["a"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["b"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["shape"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SSEsim"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SSEobs"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"9.482585","2":"1.266843","3":"77.80415","4":"12.878601","5":"14.211118","_rn_":"1"},{"1":"9.676476","2":"1.860990","3":"64.67423","4":"19.373034","5":"11.189969","_rn_":"2"},{"1":"9.588703","2":"1.713069","3":"106.35903","4":"19.717746","5":"10.417141","_rn_":"3"},{"1":"11.042771","2":"2.280507","3":"58.85358","4":"29.714912","5":"18.189727","_rn_":"4"},{"1":"8.833748","2":"1.238123","3":"103.24532","4":"13.531939","5":"9.465253","_rn_":"5"},{"1":"9.551566","2":"1.548579","3":"133.61794","4":"6.168018","5":"10.498559","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="section-exercise-4.3b." class="section level2">
<h2><strong>Exercise 4.3b</strong>.</h2>
<p>In your Word document, please explain how you interpret the Bayesian
p-value in the previous example. What Bayesian p-value would you expect
if the model fit was perfect? What would you expect if the model fit was
poor? What does the Bayesian p-value tell us about how well the Ricker
and M-M models fit the data? Does one model fit better than the
other?</p>
</div>
<div id="section-exercise-4.4-optional" class="section level2">
<h2>Exercise 4.4 (optional)</h2>
<p>DIC (analogous to AIC) is a model selection criterion for Baysian
models fitted with MCMC. Just like for AIC (see model selection
lecture), models with smaller values of DIC are favored. Which model
(M-M or Ricker) is the better model based on DIC? What does the
difference in DIC mean in terms of the strength of evidence in support
of one of these models as the “best model”? [You should be aware that
DIC is not a perfect solution for Bayesian model selection. For one, it
is only valid if the posterior is approximately multivariate normal]</p>
<p>WAIC (also analogous to AIC) is another model selection criterion for
Bayesian models fitted with MCMC. Just like for AIC, models with smaller
values of WAIC are favored. Which model (M-M or Ricker) is the better
model based on WAIC? What does the difference in WAIC mean in terms of
the strength of evidence in support of one of these models as the “best
model”?</p>
<pre><code>## This is loo version 2.6.0</code></pre>
<pre><code>## - Online documentation and vignettes at mc-stan.org/loo</code></pre>
<pre><code>## - As of v2.0.0 loo defaults to 1 core but we recommend using as many as possible. Use the &#39;cores&#39; argument or set options(mc.cores = NUM_CORES) for an entire session.</code></pre>
<pre><code>## - Windows 10 users: loo may be very slow if &#39;mc.cores&#39; is set in your .Rprofile file (see https://github.com/stan-dev/loo/issues/94).</code></pre>
<pre><code>## Warning: 
## 1 (3.7%) p_waic estimates greater than 0.4. We recommend trying loo instead.</code></pre>
<pre><code>## Warning: 
## 2 (7.4%) p_waic estimates greater than 0.4. We recommend trying loo instead.</code></pre>
<p>Here are the results I got:</p>
<pre class="r"><code>DIC_ricker</code></pre>
<pre><code>## [1] 66.14244</code></pre>
<pre class="r"><code>DIC_MM</code></pre>
<pre><code>## [1] 60.02706</code></pre>
<pre class="r"><code>WAIC_ricker$estimates[&quot;waic&quot;,]</code></pre>
<pre><code>##  Estimate        SE 
## 66.205472  8.505722</code></pre>
<pre class="r"><code>WAIC_mm$estimates[&quot;waic&quot;,]</code></pre>
<pre><code>##  Estimate        SE 
## 60.157326  9.151978</code></pre>
<p>–End of lab 4–</p>
<p>
<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
library(gradethis)
library(dplyr)
library(HDInterval)
library(emdbook)
library(jagsUI)

tutorial_options(
  exercise.reveal_solution = FALSE
)
gradethis_setup(
  pass.praise = TRUE,
  fail.encourage = TRUE,
  fail.hint = TRUE
)
knitr::opts_chunk$set(echo = TRUE)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::prepare_tutorial_state(session)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::i18n_observe_tutorial_language(input, session)
</script>


<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::event_trigger(session, "session_stop")
      })
</script>
 
<script type="application/shiny-prerendered" data-context="data">

library(emdbook)

MyxDat <- MyxoTiter_sum
Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
head(Myx)

</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-q4_1a-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-q4_1a-code-editor`)), session)
output$`tutorial-exercise-q4_1a-output` <- renderUI({
  `tutorial-exercise-q4_1a-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "q4_1a", global_setup = structure(c("library(learnr)", 
"library(gradethis)", "library(dplyr)", "library(HDInterval)", 
"library(emdbook)", "library(jagsUI)", "", "tutorial_options(", 
"  exercise.reveal_solution = FALSE", ")", "gradethis_setup(", 
"  pass.praise = TRUE,", "  fail.encourage = TRUE,", "  fail.hint = TRUE", 
")", "knitr::opts_chunk$set(echo = TRUE)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "q4_1a", code = "Myx_Ricker_JAGS <- function(data,CImethod,CIlevel){\n    # [add code here!]\n}\n\n# MyxDat <- emdbook::MyxoTiter_sum\n# Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data\n# this <- Myx_Ricker_JAGS(data=Myx[,-1],JAGScode = \"BUGSmodel_ricker.txt\", CImethod = \"HPD\", CIlevel = 0.95)\n# test <- this$conf.ints", 
        opts = list(label = "\"q4_1a\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = structure(c("", "grade_this({", "  fail_if(!length(.result(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88))==3, \"your function output should be a list with three elements\")", 
    "  fail_if(!near(.result(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88)[[1]][1],", 
    "              .solution(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88)[[1]][1],0.2))", 
    "  pass_if(near(.result(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88)[[2]][1,1],", 
    "              .solution(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88)[[2]][1,1],0.2))", 
    "  fail()", "})", ""), chunk_opts = list(label = "q4_1a-check", 
        echo = F)), solution = structure(c("", "########", "# 4.1a", 
    "", "library(HDInterval)", "library(emdbook)", "library(jagsUI)", 
    "", "Ricker <- function(x,a,b){", "  a*x*exp(-b*x)", "}", 
    "", "", "#params.to.store <- c(\"shape\",\"a\",\"b\")    # specify the parameters we want to get the posteriors for", 
    "", "#jags.fit_1a <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file=\"BUGSmodel_ricker.txt\",n.chains = 3,n.burnin = 5000,n.thin = 20 )", 
    "", "#jags.fit_1a   # test the model fit", "", "", "########", 
    "# package into function", "", "Myx_Ricker_JAGS <- function(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.95){", 
    "  ", "  filename <- \"BUGSmodel_ricker.txt\"", "  cat(\"", 
    "      model {", "        ", "        #############", "        # LIKELIHOOD", 
    "        ############", "        for(obs in 1:n.observations){", 
    "          titer[obs] ~ dgamma(shape,rate[obs])", "          rate[obs] <- shape/exp.titer[obs]", 
    "          exp.titer[obs] <- a*days[obs]*exp(-1*b*days[obs])", 
    "        }", "        ", "        #############", "        # PRIORS", 
    "        ############", "        shape ~ dgamma(0.01,0.01)", 
    "        a ~ dgamma(0.01,0.01)", "        b ~ dgamma(0.01,0.01)", 
    "      }", "    \",file=filename", "  )", "", "  ", "  myx.data.for.bugs <- list(", 
    "    titer = data[,2],", "    days =data[,1],", "    n.observations = nrow(data)", 
    "  )", "  ", "  init.vals.for.bugs <- function(){", "    list(", 
    "      shape=runif(1,20,30),", "      a=runif(1,0.05,0.3),", 
    "      b=runif(1,1,1.3)", "    )", "  }", "  ", "  params.to.store <- c(\"shape\",\"a\",\"b\")    # specify the parameters we want to get the posteriors for", 
    "  ", "  jags.fit_1a <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file=filename,n.chains = 3,n.burnin = 5000,n.thin = 20,parallel=TRUE )", 
    "  jags.fit_1a_coda <- jags.fit_1a$samples", "  #summary(jagsfit.mcmc.1a)", 
    "  plot(jags.fit_1a_coda)", "  temp <- densityplot(jags.fit_1a_coda)", 
    "  print(temp)", "  plot(data[,1],data[,2],xlab=\"days\",ylab=\"titer\",ylim=c(1,13),xlim=c(0,10))", 
    "  amean <- mean(jags.fit_1a$sims.list$a)", "  bmean <- mean(jags.fit_1a$sims.list$b)", 
    "  shapemean <- mean(jags.fit_1a$sims.list$shape)", "  curve(Ricker(x,amean,bmean),0,10,add=T,lwd=2,col=\"green\")", 
    "  posterior_mean <- c(amean,bmean,shapemean)", "  ", "  cintervals <- matrix(NA,nrow=2,ncol=3)", 
    "  colnames(cintervals) <- c(\"a\",\"b\",\"shape\")", "  if(CImethod==\"HPD\"){", 
    "    cintervals[,\"a\"] <- hdi(jags.fit_1a$sims.list$a,credMass = CIlevel)", 
    "    cintervals[,\"b\"] <- hdi(jags.fit_1a$sims.list$b,credMass = CIlevel)", 
    "    cintervals[,\"shape\"] <- hdi(jags.fit_1a$sims.list$shape,credMass = CIlevel)", 
    "  }else{", "    cintervals[,\"a\"] <- quantile(jags.fit_1a$sims.list$a,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))", 
    "    cintervals[,\"b\"] <- quantile(jags.fit_1a$sims.list$b,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))", 
    "    cintervals[,\"shape\"] <- quantile(jags.fit_1a$sims.list$shape,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))", 
    "  }", "  gelmandiag <- gelman.diag(jags.fit_1a_coda)", "", 
    "  output = list(", "    post.mean = posterior_mean,", "    conf.ints = cintervals,", 
    "    gelman.rubin = gelmandiag$mpsrf ", "  )", "  return(output)  ", 
    "}", "", ""), chunk_opts = list(label = "q4_1a-solution", 
        echo = FALSE, context = "data")), tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "LAB4_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "LAB4_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 6.5, fig.height = 4, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 624, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = TRUE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        max.print = 1000, exercise.timelimit = 60, exercise.checker = "function (label = NULL, solution_code = NULL, user_code = NULL, \n    check_code = NULL, envir_result = NULL, evaluate_result = NULL, \n    envir_prep = NULL, last_value = NULL, stage = NULL, ..., \n    solution_eval_fn = NULL) \n{\n    (utils::getFromNamespace(\"check_exercise\", \"gradethis\"))(label = label, \n        solution_code = solution_code, user_code = user_code, \n        check_code = check_code, envir_result = envir_result, \n        evaluate_result = evaluate_result, envir_prep = envir_prep, \n        last_value = last_value, stage = stage, ...)\n}", 
        exercise.error.check.code = "gradethis_error_checker()", 
        exercise.reveal_solution = FALSE, label = "q4_1a", exercise = TRUE, 
        code = c("Myx_Ricker_JAGS <- function(data,CImethod,CIlevel){", 
        "    # [add code here!]", "}", "", "# MyxDat <- emdbook::MyxoTiter_sum", 
        "# Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data", 
        "# this <- Myx_Ricker_JAGS(data=Myx[,-1],JAGScode = \"BUGSmodel_ricker.txt\", CImethod = \"HPD\", CIlevel = 0.95)", 
        "# test <- this$conf.ints"), out.width.px = 624, out.height.px = 384, 
        params.src = "q4_1a, exercise=TRUE", fig.num = 0, exercise.df_print = "paged"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>


<script type="application/shiny-prerendered" data-context="data">

########
# 4.1a

library(HDInterval)
library(emdbook)
library(jagsUI)

Ricker <- function(x,a,b){
  a*x*exp(-b*x)
}


#params.to.store <- c("shape","a","b")    # specify the parameters we want to get the posteriors for

#jags.fit_1a <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file="BUGSmodel_ricker.txt",n.chains = 3,n.burnin = 5000,n.thin = 20 )

#jags.fit_1a   # test the model fit


########
# package into function

Myx_Ricker_JAGS <- function(data=Myx[,-1],CImethod="HPD",CIlevel=0.95){
  
  filename <- "BUGSmodel_ricker.txt"
cat("
    model {
      
      #############
      # LIKELIHOOD
      ############
      for(obs in 1:n.observations){
        titer[obs] ~ dgamma(shape,rate[obs])
        rate[obs] <- shape/exp.titer[obs]
        exp.titer[obs] <- a*days[obs]*exp(-1*b*days[obs])
      }
      
      #############
      # PRIORS
      ############
      shape ~ dgamma(0.01,0.01)
      a ~ dgamma(0.01,0.01)
      b ~ dgamma(0.01,0.01)
    }
  ",file=filename
)

  myx.data.for.bugs <- list(
    titer = data[,2],
    days =data[,1],
    n.observations = nrow(data)
  )
  
  init.vals.for.bugs <- function(){
    list(
      shape=runif(1,20,30),
      a=runif(1,0.05,0.3),
      b=runif(1,1,1.3)
    )
  }
  
  params.to.store <- c("shape","a","b")    # specify the parameters we want to get the posteriors for
  
  jags.fit_1a <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file=filename,n.chains = 3,n.burnin = 5000,n.thin = 20,parallel=TRUE )
  jags.fit_1a_coda <- jags.fit_1a$samples
  #summary(jagsfit.mcmc.1a)
  plot(jags.fit_1a_coda)
  temp <- densityplot(jags.fit_1a_coda)
  print(temp)
  plot(data[,1],data[,2],xlab="days",ylab="titer",ylim=c(1,13),xlim=c(0,10))
  amean <- mean(jags.fit_1a$sims.list$a)
  bmean <- mean(jags.fit_1a$sims.list$b)
  shapemean <- mean(jags.fit_1a$sims.list$shape)
  curve(Ricker(x,amean,bmean),0,10,add=T,lwd=2,col="green")
  posterior_mean <- c(amean,bmean,shapemean)
  
  cintervals <- matrix(NA,nrow=2,ncol=3)
  colnames(cintervals) <- c("a","b","shape")
  if(CImethod=="HPD"){
    cintervals[,"a"] <- hdi(jags.fit_1a$sims.list$a,credMass = CIlevel)
    cintervals[,"b"] <- hdi(jags.fit_1a$sims.list$b,credMass = CIlevel)
    cintervals[,"shape"] <- hdi(jags.fit_1a$sims.list$shape,credMass = CIlevel)
  }else{
    cintervals[,"a"] <- quantile(jags.fit_1a$sims.list$a,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))
    cintervals[,"b"] <- quantile(jags.fit_1a$sims.list$b,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))
    cintervals[,"shape"] <- quantile(jags.fit_1a$sims.list$shape,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))
  }
  gelmandiag <- gelman.diag(jags.fit_1a_coda)

  output = list(
    post.mean = posterior_mean,
    conf.ints = cintervals,
    gelman.rubin = gelmandiag$mpsrf 
  )
  return(output)  
}


</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-q4_2a-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-q4_2a-code-editor`)), session)
output$`tutorial-exercise-q4_2a-output` <- renderUI({
  `tutorial-exercise-q4_2a-result`()
})
</script>


<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "q4_2a", global_setup = structure(c("library(learnr)", 
"library(gradethis)", "library(dplyr)", "library(HDInterval)", 
"library(emdbook)", "library(jagsUI)", "", "tutorial_options(", 
"  exercise.reveal_solution = FALSE", ")", "gradethis_setup(", 
"  pass.praise = TRUE,", "  fail.encourage = TRUE,", "  fail.hint = TRUE", 
")", "knitr::opts_chunk$set(echo = TRUE)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "q4_2a", code = "Myx_MM_JAGS <- function(data,CImethod,CIlevel){\n    # [add code here!]\n}\n\n# MyxDat <- emdbook::MyxoTiter_sum\n# Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data\n# this <- Myx_MM_JAGS(data=Myx[,-1], CImethod = \"HPD\", CIlevel = 0.95)\n# test <- this$conf.ints", 
        opts = list(label = "\"q4_2a\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = structure(c("grade_this({", "  fail_if(!length(.result(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88))==3, \"your function output should be a list with three elements\")", 
    "  fail_if(!near(.result(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88)[[1]][1],", 
    "              .solution(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88)[[1]][1],0.5))", 
    "  pass_if(near(.result(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88)[[2]][1,1],", 
    "              .solution(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.88)[[2]][1,1],0.5))", 
    "  fail()", "})"), chunk_opts = list(label = "q4_2a-check", 
        echo = F)), solution = structure(c("", "library(HDInterval)", 
    "library(emdbook)", "library(jagsUI)", "", "#####", "# 4.2a", 
    "", "MMFunc <- function(x,a,b){", "  (a*x)/(b+x)", "}", "", 
    "", "# MyxDat <- MyxoTiter_sum", "# Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data", 
    "# #head(Myx)", "# ", "# myx.data.for.bugs <- list(", "#   titer = Myx$titer,", 
    "#   days = Myx$day,", "#   n.observations = nrow(Myx)", 
    "# )", "# ", "# init.vals.for.bugs2 <- function(){", "#   list(", 
    "#     shape=runif(1,20,30),", "#     a=runif(1,8,9),", "#     b=runif(1,1,1.5)", 
    "#   )", "# }", "#init.vals.for.bugs()", "", "params.to.store <- c(\"shape\",\"a\",\"b\")    # specify the parameters we want to get the posteriors for", 
    "", "#jags.fit_2a <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file=\"BUGSmodel_mm.txt\",n.chains = 3,n.burnin = 5000,n.thin = 20, parallel=TRUE )", 
    "", "#jags.fit_2a   # test the model fit", "", "", "########", 
    "# package into function", "", "Myx_MM_JAGS <- function(data=Myx[,-1],CImethod=\"HPD\",CIlevel=0.95){", 
    "  filename <- \"BUGSmodel_mm.txt\"", "  cat(\"", "      model {", 
    "        ", "        #############", "        # LIKELIHOOD", 
    "        ############", "        for(obs in 1:n.observations){", 
    "          titer[obs] ~ dgamma(shape,rate[obs])", "          rate[obs] <- shape/exp.titer[obs]", 
    "          exp.titer[obs] <- (a*days[obs]) / (b+days[obs])", 
    "        }", "        ", "        #############", "        # PRIORS", 
    "        ############", "        shape ~ dgamma(0.01,0.01)", 
    "        a ~ dgamma(0.01,0.01)", "        b ~ dgamma(0.01,0.01)", 
    "      }", "    \",file=filename", "  )", "", "  myx.data.for.bugs <- list(", 
    "    titer = data[,2],", "    days =data[,1],", "    n.observations = nrow(data)", 
    "  )", "  ", "  init.vals.for.bugs2 <- function(){", "    list(", 
    "      shape=runif(1,20,30),", "      a=runif(1,8,9),", "      b=runif(1,1,1.5)", 
    "    )", "  }", "  ", "  params.to.store <- c(\"shape\",\"a\",\"b\")    # specify the parameters we want to get the posteriors for", 
    "  ", "  jags.fit_2a <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs2,parameters.to.save=params.to.store,n.iter=50000,model.file=filename,n.chains = 3,n.burnin = 5000,n.thin = 20,parallel=TRUE )", 
    "  jags.fit_2a_coda <- jags.fit_2a$samples", "  plot(jags.fit_2a_coda)", 
    "  temp <- densityplot(jags.fit_2a_coda)", "  print(temp)", 
    "  plot(data[,1],data[,2],xlab=\"days\",ylab=\"titer\",ylim=c(1,13),xlim=c(0,10))", 
    "  amean <- mean(jags.fit_2a$sims.list$a)", "  bmean <- mean(jags.fit_2a$sims.list$b)", 
    "  shapemean <- mean(jags.fit_2a$sims.list$shape)", "  curve(MMFunc(x,amean,bmean),0,10,add=T,lwd=2,col=\"green\")", 
    "  posterior_mean <- c(amean,bmean,shapemean)", "  ", "  cintervals <- matrix(NA,nrow=2,ncol=3)", 
    "  colnames(cintervals) <- c(\"a\",\"b\",\"shape\")", "  if(CImethod==\"HPD\"){", 
    "    cintervals[,\"a\"] <- hdi(jags.fit_2a$sims.list$a,credMass = CIlevel)", 
    "    cintervals[,\"b\"] <- hdi(jags.fit_2a$sims.list$b,credMass = CIlevel)", 
    "    cintervals[,\"shape\"] <- hdi(jags.fit_2a$sims.list$shape,credMass = CIlevel)", 
    "  }else{", "    cintervals[,\"a\"] <- quantile(jags.fit_2a$sims.list$a,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))", 
    "    cintervals[,\"b\"] <- quantile(jags.fit_2a$sims.list$b,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))", 
    "    cintervals[,\"shape\"] <- quantile(jags.fit_2a$sims.list$shape,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))", 
    "  }", "  gelmandiag <- gelman.diag(jags.fit_2a_coda)", "", 
    "  output = list(", "    post.mean = posterior_mean,", "    conf.ints = cintervals,", 
    "    gelman.rubin = gelmandiag$mpsrf ", "  )", "  return(output)  ", 
    "}", "", ""), chunk_opts = list(label = "q4_2a-solution", 
        echo = FALSE, context = "data")), tests = NULL, options = list(
        eval = FALSE, echo = TRUE, results = "markup", tidy = FALSE, 
        tidy.opts = NULL, collapse = FALSE, prompt = FALSE, comment = NA, 
        highlight = FALSE, size = "normalsize", background = "#F7F7F7", 
        strip.white = TRUE, cache = 0, cache.path = "LAB4_cache/html/", 
        cache.vars = NULL, cache.lazy = TRUE, dependson = NULL, 
        autodep = FALSE, cache.rebuild = FALSE, fig.keep = "high", 
        fig.show = "asis", fig.align = "default", fig.path = "LAB4_files/figure-html/", 
        dev = "png", dev.args = NULL, dpi = 192, fig.ext = "png", 
        fig.width = 6.5, fig.height = 4, fig.env = "figure", 
        fig.cap = NULL, fig.scap = NULL, fig.lp = "fig:", fig.subcap = NULL, 
        fig.pos = "", out.width = 624, out.height = NULL, out.extra = NULL, 
        fig.retina = 2, external = TRUE, sanitize = FALSE, interval = 1, 
        aniopts = "controls,loop", warning = TRUE, error = FALSE, 
        message = TRUE, render = NULL, ref.label = NULL, child = NULL, 
        engine = "r", split = FALSE, include = TRUE, purl = TRUE, 
        max.print = 1000, exercise.timelimit = 60, exercise.checker = "function (label = NULL, solution_code = NULL, user_code = NULL, \n    check_code = NULL, envir_result = NULL, evaluate_result = NULL, \n    envir_prep = NULL, last_value = NULL, stage = NULL, ..., \n    solution_eval_fn = NULL) \n{\n    (utils::getFromNamespace(\"check_exercise\", \"gradethis\"))(label = label, \n        solution_code = solution_code, user_code = user_code, \n        check_code = check_code, envir_result = envir_result, \n        evaluate_result = evaluate_result, envir_prep = envir_prep, \n        last_value = last_value, stage = stage, ...)\n}", 
        exercise.error.check.code = "gradethis_error_checker()", 
        exercise.reveal_solution = FALSE, label = "q4_2a", exercise = TRUE, 
        code = c("Myx_MM_JAGS <- function(data,CImethod,CIlevel){", 
        "    # [add code here!]", "}", "", "# MyxDat <- emdbook::MyxoTiter_sum", 
        "# Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data", 
        "# this <- Myx_MM_JAGS(data=Myx[,-1], CImethod = \"HPD\", CIlevel = 0.95)", 
        "# test <- this$conf.ints"), out.width.px = 624, out.height.px = 384, 
        params.src = "q4_2a, exercise=TRUE", fig.num = 0, exercise.df_print = "paged"), 
    engine = "r", version = "4"), class = c("r", "tutorial_exercise"
)))
</script>
 
<script type="application/shiny-prerendered" data-context="data">

library(HDInterval)
library(emdbook)
library(jagsUI)

#####
# 4.2a

MMFunc <- function(x,a,b){
  (a*x)/(b+x)
}


# MyxDat <- MyxoTiter_sum
# Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
# #head(Myx)
# 
# myx.data.for.bugs <- list(
#   titer = Myx$titer,
#   days = Myx$day,
#   n.observations = nrow(Myx)
# )
# 
# init.vals.for.bugs2 <- function(){
#   list(
#     shape=runif(1,20,30),
#     a=runif(1,8,9),
#     b=runif(1,1,1.5)
#   )
# }
#init.vals.for.bugs()

params.to.store <- c("shape","a","b")    # specify the parameters we want to get the posteriors for

#jags.fit_2a <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file="BUGSmodel_mm.txt",n.chains = 3,n.burnin = 5000,n.thin = 20, parallel=TRUE )

#jags.fit_2a   # test the model fit


########
# package into function

Myx_MM_JAGS <- function(data=Myx[,-1],CImethod="HPD",CIlevel=0.95){
  filename <- "BUGSmodel_mm.txt"
  cat("
      model {
        
        #############
        # LIKELIHOOD
        ############
        for(obs in 1:n.observations){
          titer[obs] ~ dgamma(shape,rate[obs])
          rate[obs] <- shape/exp.titer[obs]
          exp.titer[obs] <- (a*days[obs]) / (b+days[obs])
        }
        
        #############
        # PRIORS
        ############
        shape ~ dgamma(0.01,0.01)
        a ~ dgamma(0.01,0.01)
        b ~ dgamma(0.01,0.01)
      }
    ",file=filename
  )
    
  myx.data.for.bugs <- list(
    titer = data[,2],
    days =data[,1],
    n.observations = nrow(data)
  )
  
  init.vals.for.bugs2 <- function(){
    list(
      shape=runif(1,20,30),
      a=runif(1,8,9),
      b=runif(1,1,1.5)
    )
  }
  
  params.to.store <- c("shape","a","b")    # specify the parameters we want to get the posteriors for
  
  jags.fit_2a <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs2,parameters.to.save=params.to.store,n.iter=50000,model.file=filename,n.chains = 3,n.burnin = 5000,n.thin = 20,parallel=TRUE )
  jags.fit_2a_coda <- jags.fit_2a$samples
  plot(jags.fit_2a_coda)
  temp <- densityplot(jags.fit_2a_coda)
  print(temp)
  plot(data[,1],data[,2],xlab="days",ylab="titer",ylim=c(1,13),xlim=c(0,10))
  amean <- mean(jags.fit_2a$sims.list$a)
  bmean <- mean(jags.fit_2a$sims.list$b)
  shapemean <- mean(jags.fit_2a$sims.list$shape)
  curve(MMFunc(x,amean,bmean),0,10,add=T,lwd=2,col="green")
  posterior_mean <- c(amean,bmean,shapemean)
  
  cintervals <- matrix(NA,nrow=2,ncol=3)
  colnames(cintervals) <- c("a","b","shape")
  if(CImethod=="HPD"){
    cintervals[,"a"] <- hdi(jags.fit_2a$sims.list$a,credMass = CIlevel)
    cintervals[,"b"] <- hdi(jags.fit_2a$sims.list$b,credMass = CIlevel)
    cintervals[,"shape"] <- hdi(jags.fit_2a$sims.list$shape,credMass = CIlevel)
  }else{
    cintervals[,"a"] <- quantile(jags.fit_2a$sims.list$a,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))
    cintervals[,"b"] <- quantile(jags.fit_2a$sims.list$b,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))
    cintervals[,"shape"] <- quantile(jags.fit_2a$sims.list$shape,c((1-CIlevel)/2 ,CIlevel+((1-CIlevel)/2)))
  }
  gelmandiag <- gelman.diag(jags.fit_2a_coda)

  output = list(
    post.mean = posterior_mean,
    conf.ints = cintervals,
    gelman.rubin = gelmandiag$mpsrf 
  )
  return(output)  
}


</script>


<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-q4_3a-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-q4_3a-code-editor`)), session)
output$`tutorial-exercise-q4_3a-output` <- renderUI({
  `tutorial-exercise-q4_3a-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::store_exercise_cache(structure(list(label = "q4_3a", global_setup = structure(c("library(learnr)", 
"library(gradethis)", "library(dplyr)", "library(HDInterval)", 
"library(emdbook)", "library(jagsUI)", "", "tutorial_options(", 
"  exercise.reveal_solution = FALSE", ")", "gradethis_setup(", 
"  pass.praise = TRUE,", "  fail.encourage = TRUE,", "  fail.hint = TRUE", 
")", "knitr::opts_chunk$set(echo = TRUE)"), chunk_opts = list(
    label = "setup", include = FALSE)), setup = NULL, chunks = list(
    list(label = "q4_3a", code = "Myx_PostPredCheck <- function(MCMC1,MCMC2){\n    # [add code here!]\n}\n\n# Myx_PostPredCheck(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)\n", 
        opts = list(label = "\"q4_3a\"", exercise = "TRUE"), 
        engine = "r")), code_check = NULL, error_check = NULL, 
    check = structure(c("grade_this({", "  fail_if(!length(.result(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm))==3, \"your function output should be a list with three elements\")", 
    "  fail_if(!near(.result(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)[[1]][1],", 
    "              .solution(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)[[1]][1],0.15))", 
    "  fail_if(!near(.result(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)[[1]][2],", 
    "              .solution(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)[[1]][2],0.15))", 
    "  pass_if(near(sum(apply(.result(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)[[2]],2,mean)),", 
    "              sum(apply(.solution(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)[[2]],2,mean)),1))", 
    "  fail()", "})"), chunk_opts = list(label = "q4_3a-check", 
        echo = F)), solution = structure(c("", "Myx_PostPredCheck <- function(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm){", 
    "  lots <- 1000", "  nMCMC <- min(length(jags.fit_ricker$sims.list[[1]]),length(jags.fit_mm$sims.list[[1]]))", 
    "  ", "     # hard-code the data", "  MyxDat <- MyxoTiter_sum", 
    "  Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data  ", 
    "  nobs <- nrow(Myx)", "  ", "  SSEobs_rick <- numeric(lots)", 
    "  SSEobs_mm <- numeric(lots)", "  SSEsim_rick <- numeric(lots)", 
    "  SSEsim_mm <- numeric(lots)", "  ", "  params_rick <- matrix(NA, nrow=lots,ncol=3)", 
    "  params_mm <- matrix(NA, nrow=lots,ncol=3)", "  ", "  colnames(params_rick) <- c(\"a\",\"b\",\"shape\")", 
    "  colnames(params_mm) <- c(\"a\",\"b\",\"shape\")", "  ", 
    "  alldays <- sort(unique(Myx$day))", "  allsims_rick <- matrix(nrow=lots,ncol=length(alldays)) ", 
    "  allsims_mm <- matrix(nrow=lots,ncol=length(alldays)) ", 
    "  colnames(allsims_rick) <- alldays", "  colnames(allsims_mm) <- alldays", 
    "  ", "  i=2", "  for(i in 1:lots){", "    random_index <- sample(1:nMCMC,1)", 
    "    params_rick[i,] <- c(a=MCMC1$sims.list$a[random_index],", 
    "                     b=MCMC1$sims.list$b[random_index],", 
    "                     shape=MCMC1$sims.list$shape[random_index])", 
    "    params_mm[i,] <- c(a=MCMC2$sims.list$a[random_index],", 
    "                     b=MCMC2$sims.list$b[random_index],", 
    "                     shape=MCMC2$sims.list$shape[random_index])", 
    "    ", "    ### loop through titer observations", "    exptiter_rick <- Ricker(Myx$day,params_rick[i,\"a\"],params_rick[i,\"b\"]) ", 
    "    exptiter_mm <- MMFunc(Myx$day,params_mm[i,\"a\"],params_mm[i,\"b\"])", 
    "    simobs_rick <- rgamma(nobs,shape=params_rick[i,\"shape\"],rate=(params_rick[i,\"shape\"]/exptiter_rick))", 
    "    simobs_mm <- rgamma(nobs,shape=params_mm[i,\"shape\"],rate=(params_mm[i,\"shape\"]/exptiter_mm))", 
    "    SSEobs_rick[i] <- sum((Myx$titer-exptiter_rick)^2)", 
    "    SSEobs_mm[i] <- sum((Myx$titer-exptiter_mm)^2)", "    SSEsim_rick[i] <- sum((simobs_rick-exptiter_rick)^2)", 
    "    SSEsim_mm[i] <- sum((simobs_mm-exptiter_mm)^2)", "    ", 
    "    allsims_rick[i,] <- tapply(simobs_rick,Myx$day,function(t) t[sample.int(length(t))][1] )", 
    "    allsims_mm[i,] <- tapply(simobs_mm,Myx$day,function(t) t[sample.int(length(t))][1] )", 
    "  }", "  ", "  boxplot(allsims_rick,xlab=\"Days\",ylab=\"Titer\",xlim=c(0,10),main=\"Ricker\",at=as.numeric(colnames(allsims_rick)))", 
    "  points(Myx$day,Myx$titer,col=\"green\",pch=19,cex=2)", 
    "  ", "  boxplot(allsims_mm,xlab=\"Days\",ylab=\"Titer\",xlim=c(0,10),main=\"M-M\",at=as.numeric(colnames(allsims_mm)))", 
    "  points(Myx$day,Myx$titer,col=\"green\",pch=19,cex=2)", 
    "  ", "  plot(SSEsim_rick~SSEobs_rick,main=\"Posterior Pred Check, Ricker\")", 
    "  abline(0,1,col=\"red\")", "  ", "  plot(SSEsim_mm~SSEobs_mm,main=\"Posterior Pred Check, M-M\")", 
    "  abline(0,1,col=\"red\")", "  ", "  pval_rick <- length(which(SSEsim_rick>SSEobs_rick))/lots", 
    "  ", "  pval_mm <- length(which(SSEsim_mm>SSEobs_mm))/lots", 
    "  ", "  output <- list()", "  output[[\"p-vals\"]] <- c(pval_rick,pval_mm)", 
    "  ", "  output[[\"PPC_rick\"]] <- as.data.frame(cbind(params_rick,SSEsim_rick,SSEobs_rick))", 
    "  output[[\"PPC_mm\"]] <- as.data.frame(cbind(params_mm,SSEsim_mm,SSEobs_mm))", 
    "  ", "  colnames <- c(\"a\",\"b\",\"shape\",\"SSEsim\",\"SSEobs\")", 
    "  names(output[[\"PPC_rick\"]]) <- colnames", "  names(output[[\"PPC_mm\"]]) <- colnames", 
    "  ", "  return(output)", "  ", "}", ""), chunk_opts = list(
        label = "q4_3a-solution", echo = FALSE, context = "data")), 
    tests = NULL, options = list(eval = FALSE, echo = TRUE, results = "markup", 
        tidy = FALSE, tidy.opts = NULL, collapse = FALSE, prompt = FALSE, 
        comment = NA, highlight = FALSE, size = "normalsize", 
        background = "#F7F7F7", strip.white = TRUE, cache = 0, 
        cache.path = "LAB4_cache/html/", cache.vars = NULL, cache.lazy = TRUE, 
        dependson = NULL, autodep = FALSE, cache.rebuild = FALSE, 
        fig.keep = "high", fig.show = "asis", fig.align = "default", 
        fig.path = "LAB4_files/figure-html/", dev = "png", dev.args = NULL, 
        dpi = 192, fig.ext = "png", fig.width = 6.5, fig.height = 4, 
        fig.env = "figure", fig.cap = NULL, fig.scap = NULL, 
        fig.lp = "fig:", fig.subcap = NULL, fig.pos = "", out.width = 624, 
        out.height = NULL, out.extra = NULL, fig.retina = 2, 
        external = TRUE, sanitize = FALSE, interval = 1, aniopts = "controls,loop", 
        warning = TRUE, error = FALSE, message = TRUE, render = NULL, 
        ref.label = NULL, child = NULL, engine = "r", split = FALSE, 
        include = TRUE, purl = TRUE, max.print = 1000, exercise.timelimit = 60, 
        exercise.checker = "function (label = NULL, solution_code = NULL, user_code = NULL, \n    check_code = NULL, envir_result = NULL, evaluate_result = NULL, \n    envir_prep = NULL, last_value = NULL, stage = NULL, ..., \n    solution_eval_fn = NULL) \n{\n    (utils::getFromNamespace(\"check_exercise\", \"gradethis\"))(label = label, \n        solution_code = solution_code, user_code = user_code, \n        check_code = check_code, envir_result = envir_result, \n        evaluate_result = evaluate_result, envir_prep = envir_prep, \n        last_value = last_value, stage = stage, ...)\n}", 
        exercise.error.check.code = "gradethis_error_checker()", 
        exercise.reveal_solution = FALSE, label = "q4_3a", exercise = TRUE, 
        code = c("Myx_PostPredCheck <- function(MCMC1,MCMC2){", 
        "    # [add code here!]", "}", "", "# Myx_PostPredCheck(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm)", 
        ""), out.width.px = 624, out.height.px = 384, params.src = "q4_3a, exercise=TRUE", 
        fig.num = 0, exercise.df_print = "paged"), engine = "r", 
    version = "4"), class = c("r", "tutorial_exercise")))
</script>


<script type="application/shiny-prerendered" data-context="data">

##########
# 4.3a

######
# first set up the necessary data objects

MyxDat <- MyxoTiter_sum
Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data
#head(Myx)

myx.data.for.bugs <- list(
  titer = Myx$titer,
  days = Myx$day,
  n.observations = nrow(Myx)
)

#myx.data.for.bugs

init.vals.for.bugs <- function(){
  list(
    shape=runif(1,20,30),
    a=runif(1,0.05,0.3),
    b=runif(1,1,1.3)
  )
}

init.vals.for.bugs2 <- function(){
  list(
    shape=runif(1,20,30),
    a=runif(1,8,9),
    b=runif(1,1,1.5)
  )
}

jags.fit_ricker <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs,parameters.to.save=params.to.store,n.iter=50000,model.file="BUGSmodel_ricker.txt",n.chains = 3,n.burnin = 5000,n.thin = 20,parallel=TRUE )

jags.fit_mm <- jags(data=myx.data.for.bugs,inits=init.vals.for.bugs2,parameters.to.save=params.to.store,n.iter=50000,model.file="BUGSmodel_mm.txt",n.chains = 3,n.burnin = 5000,n.thin = 20,parallel=TRUE )


</script>
 
<script type="application/shiny-prerendered" data-context="data">

Myx_PostPredCheck <- function(MCMC1=jags.fit_ricker,MCMC2=jags.fit_mm){
  lots <- 1000
  nMCMC <- min(length(jags.fit_ricker$sims.list[[1]]),length(jags.fit_mm$sims.list[[1]]))
  
     # hard-code the data
  MyxDat <- MyxoTiter_sum
  Myx <- subset(MyxDat,grade==1)  #Data set from grade 1 of myxo data  
  nobs <- nrow(Myx)
  
  SSEobs_rick <- numeric(lots)
  SSEobs_mm <- numeric(lots)
  SSEsim_rick <- numeric(lots)
  SSEsim_mm <- numeric(lots)
  
  params_rick <- matrix(NA, nrow=lots,ncol=3)
  params_mm <- matrix(NA, nrow=lots,ncol=3)
  
  colnames(params_rick) <- c("a","b","shape")
  colnames(params_mm) <- c("a","b","shape")
  
  alldays <- sort(unique(Myx$day))
  allsims_rick <- matrix(nrow=lots,ncol=length(alldays)) 
  allsims_mm <- matrix(nrow=lots,ncol=length(alldays)) 
  colnames(allsims_rick) <- alldays
  colnames(allsims_mm) <- alldays
  
  i=2
  for(i in 1:lots){
    random_index <- sample(1:nMCMC,1)
    params_rick[i,] <- c(a=MCMC1$sims.list$a[random_index],
                     b=MCMC1$sims.list$b[random_index],
                     shape=MCMC1$sims.list$shape[random_index])
    params_mm[i,] <- c(a=MCMC2$sims.list$a[random_index],
                     b=MCMC2$sims.list$b[random_index],
                     shape=MCMC2$sims.list$shape[random_index])
    
    ### loop through titer observations
    exptiter_rick <- Ricker(Myx$day,params_rick[i,"a"],params_rick[i,"b"]) 
    exptiter_mm <- MMFunc(Myx$day,params_mm[i,"a"],params_mm[i,"b"])
    simobs_rick <- rgamma(nobs,shape=params_rick[i,"shape"],rate=(params_rick[i,"shape"]/exptiter_rick))
    simobs_mm <- rgamma(nobs,shape=params_mm[i,"shape"],rate=(params_mm[i,"shape"]/exptiter_mm))
    SSEobs_rick[i] <- sum((Myx$titer-exptiter_rick)^2)
    SSEobs_mm[i] <- sum((Myx$titer-exptiter_mm)^2)
    SSEsim_rick[i] <- sum((simobs_rick-exptiter_rick)^2)
    SSEsim_mm[i] <- sum((simobs_mm-exptiter_mm)^2)
    
    allsims_rick[i,] <- tapply(simobs_rick,Myx$day,function(t) t[sample.int(length(t))][1] )
    allsims_mm[i,] <- tapply(simobs_mm,Myx$day,function(t) t[sample.int(length(t))][1] )
  }
  
  boxplot(allsims_rick,xlab="Days",ylab="Titer",xlim=c(0,10),main="Ricker",at=as.numeric(colnames(allsims_rick)))
  points(Myx$day,Myx$titer,col="green",pch=19,cex=2)
  
  boxplot(allsims_mm,xlab="Days",ylab="Titer",xlim=c(0,10),main="M-M",at=as.numeric(colnames(allsims_mm)))
  points(Myx$day,Myx$titer,col="green",pch=19,cex=2)
  
  plot(SSEsim_rick~SSEobs_rick,main="Posterior Pred Check, Ricker")
  abline(0,1,col="red")
  
  plot(SSEsim_mm~SSEobs_mm,main="Posterior Pred Check, M-M")
  abline(0,1,col="red")
  
  pval_rick <- length(which(SSEsim_rick>SSEobs_rick))/lots
  
  pval_mm <- length(which(SSEsim_mm>SSEobs_mm))/lots
  
  output <- list()
  output[["p-vals"]] <- c(pval_rick,pval_mm)
  
  output[["PPC_rick"]] <- as.data.frame(cbind(params_rick,SSEsim_rick,SSEobs_rick))
  output[["PPC_mm"]] <- as.data.frame(cbind(params_mm,SSEsim_mm,SSEobs_mm))
  
  colnames <- c("a","b","shape","SSEsim","SSEobs")
  names(output[["PPC_rick"]]) <- colnames
  names(output[["PPC_mm"]]) <- colnames
  
  return(output)
  
}

</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.24"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.24"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/cerulean.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.24"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.24"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.24"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.11.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["i18n"]},{"type":"character","attributes":{},"value":["21.6.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/i18n"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["i18next.min.js","tutorial-i18n-init.js"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["<script id=\"i18n-cstm-trns\" type=\"application/json\">{\"language\":\"en\",\"resources\":{\"en\":{\"translation\":{\"button\":{\"runcode\":\"Run Code\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"Hint\",\"hint_plural\":\"Hints\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"Next Hint\",\"hintprev\":\"Previous Hint\",\"solution\":\"Solution\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"Copy to Clipboard\",\"startover\":\"Start Over\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"Continue\",\"submitanswer\":\"Submit Answer\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"Previous Topic\",\"nexttopic\":\"Next Topic\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"Try Again\"},\"text\":{\"startover\":\"Start Over\",\"areyousure\":\"Are you sure you want to start over? (all exercise progress will be reset)\",\"youmustcomplete\":\"You must complete the\",\"exercise\":\"exercise\",\"exercise_plural\":\"exercises\",\"inthissection\":\"in this section before continuing.\",\"code\":\"Code\",\"enginecap\":\"{{engine}} $t(text.code)\",\"quiz\":\"Quiz\",\"blank\":\"blank\",\"blank_plural\":\"blanks\",\"exercisecontainsblank\":\"This exercise contains {{count}} $t(text.blank).\",\"pleasereplaceblank\":\"Please replace {{blank}} with valid code.\",\"unparsable\":\"It looks like this might not be valid R code. R cannot determine how to turn your text into a complete command. You may have forgotten to fill in a blank, to remove an underscore, to include a comma between arguments, or to close an opening <code>&quot;<\\/code>, <code>'<\\/code>, <code>(<\\/code> or <code>{<\\/code> with a matching <code>&quot;<\\/code>, <code>'<\\/code>, <code>)<\\/code> or <code>}<\\/code>.\\n\",\"unparsablequotes\":\"<p>It looks like your R code contains specially formatted quotation marks or &quot;curly&quot; quotes (<code>{{character}}<\\/code>) around character strings, making your code invalid. R requires character values to be contained in straight quotation marks (<code>&quot;<\\/code> or <code>'<\\/code>).<\\/p> {{code}} <p>Don't worry, this is a common source of errors when you copy code from another app that applies its own formatting to text. You can try replacing the code on that line with the following. There may be other places that need to be fixed, too.<\\/p> {{suggestion}}\\n\",\"unparsableunicode\":\"<p>It looks like your R code contains an unexpected special character (<code>{{character}}<\\/code>) that makes your code invalid.<\\/p> {{code}} <p>Sometimes your code may contain a special character that looks like a regular character, especially if you copy and paste the code from another app. Try deleting the special character from your code and retyping it manually.<\\/p>\\n\",\"unparsableunicodesuggestion\":\"<p>It looks like your R code contains an unexpected special character (<code>{{character}}<\\/code>) that makes your code invalid.<\\/p> {{code}} <p>Sometimes your code may contain a special character that looks like a regular character, especially if you copy and paste the code from another app. You can try replacing the code on that line with the following. There may be other places that need to be fixed, too.<\\/p> {{suggestion}}\\n\",\"and\":\"and\",\"or\":\"or\",\"listcomma\":\", \",\"oxfordcomma\":\",\"}}},\"fr\":{\"translation\":{\"button\":{\"runcode\":\"Lancer le Code\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"Indication\",\"hint_plural\":\"Indications\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"Indication Suivante\",\"hintprev\":\"Indication Précédente\",\"solution\":\"Solution\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"Copier dans le Presse-papier\",\"startover\":\"Recommencer\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"Continuer\",\"submitanswer\":\"Soumettre\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"Chapitre Précédent\",\"nexttopic\":\"Chapitre Suivant\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"Réessayer\"},\"text\":{\"startover\":\"Recommencer\",\"areyousure\":\"Êtes-vous certains de vouloir recommencer? (La progression sera remise à zéro)\",\"youmustcomplete\":\"Vous devez d'abord compléter\",\"exercise\":\"l'exercice\",\"exercise_plural\":\"des exercices\",\"inthissection\":\"de cette section avec de continuer.\",\"code\":\"Code\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"Quiz\",\"and\":\"et\",\"or\":\"ou\",\"oxfordcomma\":\"\"}}},\"es\":{\"translation\":{\"button\":{\"runcode\":\"Ejecutar código\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"Pista\",\"hint_plural\":\"Pistas\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"Siguiente pista\",\"hintprev\":\"Pista anterior\",\"solution\":\"Solución\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"Copiar al portapapeles\",\"startover\":\"Reiniciar\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"Continuar\",\"submitanswer\":\"Enviar respuesta\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"Tema anterior\",\"nexttopic\":\"Tema siguiente\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"Volver a intentar\"},\"text\":{\"startover\":\"Reiniciar\",\"areyousure\":\"¿De verdad quieres empezar de nuevo? (todo el progreso del ejercicio se perderá)\",\"youmustcomplete\":\"Debes completar\",\"exercise\":\"el ejercicio\",\"exercise_plural\":\"los ejercicios\",\"inthissection\":\"en esta sección antes de continuar.\",\"code\":\"Código\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"Cuestionario\",\"and\":\"y\",\"or\":\"o\",\"oxfordcomma\":\"\"}}},\"pt\":{\"translation\":{\"button\":{\"runcode\":\"Executar código\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"Dica\",\"hint_plural\":\"Dicas\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"Próxima dica\",\"hintprev\":\"Dica anterior\",\"solution\":\"Solução\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"Copiar para a área de transferência\",\"startover\":\"Reiniciar\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"Continuar\",\"submitanswer\":\"Enviar resposta\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"Tópico anterior\",\"nexttopic\":\"Próximo tópico\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"Tentar novamente\"},\"text\":{\"startover\":\"Reiniciar\",\"areyousure\":\"Tem certeza que deseja começar novamente? (todo o progresso feito será perdido)\",\"youmustcomplete\":\"Você deve completar\",\"exercise\":\"o exercício\",\"exercise_plural\":\"os exercícios\",\"inthissection\":\"nesta seção antes de continuar.\",\"code\":\"Código\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"Quiz\",\"and\":\"e\",\"or\":\"ou\",\"oxfordcomma\":\"\"}}},\"tr\":{\"translation\":{\"button\":{\"runcode\":\"Çalıştırma Kodu\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"Ipucu\",\"hint_plural\":\"İpuçları\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"Sonraki İpucu\",\"hintprev\":\"Önceki İpucu\",\"solution\":\"Çözüm\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"Pano'ya Kopyala\",\"startover\":\"Baştan Başlamak\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"Devam et\",\"submitanswer\":\"Cevabı onayla\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"Önceki Konu\",\"nexttopic\":\"Sonraki Konu\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"Tekrar Deneyin\"},\"text\":{\"startover\":\"Baştan Başlamak\",\"areyousure\":\"Baştan başlamak istediğinizden emin misiniz? (tüm egzersiz ilerlemesi kaybolacak)\",\"youmustcomplete\":\"Tamamlamalısın\",\"exercise\":\"egzersiz\",\"exercise_plural\":\"egzersizler\",\"inthissection\":\"devam etmeden önce bu bölümde\",\"code\":\"Kod\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"Sınav\",\"oxfordcomma\":\"\"}}},\"emo\":{\"translation\":{\"button\":{\"runcode\":\"🏃\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"💡\",\"hint_plural\":\"$t(button.hint)\",\"hinttitle\":\"$t(button.hint)\",\"solution\":\"🎯\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"📋\",\"startover\":\"⏮\",\"startovertitle\":\"Start Over\",\"continue\":\"✅\",\"submitanswer\":\"🆗\",\"submitanswertitle\":\"Submit Answer\",\"previoustopic\":\"⬅\",\"nexttopic\":\"➡\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"🔁\"},\"text\":{\"startover\":\"⏮\",\"areyousure\":\"🤔\",\"youmustcomplete\":\"⚠️ 👉 🧑‍💻\",\"exercise\":\"\",\"exercise_plural\":\"\",\"inthissection\":\"\",\"code\":\"💻\",\"enginecap\":\"$t(text.code) {{engine}}\",\"oxfordcomma\":\"\"}}},\"eu\":{\"translation\":{\"button\":{\"runcode\":\"Kodea egikaritu\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"Laguntza\",\"hint_plural\":\"Laguntza\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"Aurreko laguntza\",\"hintprev\":\"Hurrengo laguntza\",\"solution\":\"Ebazpena\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"Arbelean kopiatu\",\"startover\":\"Berrabiarazi\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"Jarraitu\",\"submitanswer\":\"Erantzuna bidali\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"Aurreko atala\",\"nexttopic\":\"Hurrengo atala\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"Berriro saiatu\"},\"text\":{\"startover\":\"Berrabiarazi\",\"areyousure\":\"Berriro hasi nahi duzu? (egindako lana galdu egingo da)\",\"youmustcomplete\":\"Aurrera egin baino lehen atal honetako\",\"exercise\":\"ariketa egin behar duzu.\",\"exercise_plural\":\"ariketak egin behar dituzu.\",\"inthissection\":\"\",\"code\":\"Kodea\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"Galdetegia\",\"oxfordcomma\":\"\"}}},\"de\":{\"translation\":{\"button\":{\"runcode\":\"Code ausführen\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"Tipp\",\"hint_plural\":\"Tipps\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"Nächster Tipp\",\"hintprev\":\"Vorheriger Tipp\",\"solution\":\"Lösung\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"In die Zwischenablage kopieren\",\"startover\":\"Neustart\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"Weiter\",\"submitanswer\":\"Antwort einreichen\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"Vorheriges Kapitel\",\"nexttopic\":\"Nächstes Kapitel\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"Nochmal versuchen\"},\"text\":{\"startover\":\"Neustart\",\"areyousure\":\"Bist du sicher, dass du neustarten willst? (der gesamte Lernfortschritt wird gelöscht)\",\"youmustcomplete\":\"Vervollstädinge\",\"exercise\":\"die Übung\",\"exercise_plural\":\"die Übungen\",\"inthissection\":\"in diesem Kapitel, bevor du fortfährst.\",\"code\":\"Code\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"Quiz\",\"blank\":\"Lücke\",\"blank_plural\":\"Lücken\",\"pleasereplaceblank\":\"Bitte ersetze {{blank}} mit gültigem Code.\",\"unparsable\":\"Dies scheint kein gültiger R Code zu sein. R kann deinen Text nicht in einen gültigen Befehl übersetzen. Du hast vielleicht vergessen, die Lücke zu füllen, einen Unterstrich zu entfernen, ein Komma zwischen Argumente zu setzen oder ein eröffnendes <code>&quot;<\\/code>, <code>'<\\/code>, <code>(<\\/code> oder <code>{<\\/code> mit einem zugehörigen <code>&quot;<\\/code>, <code>'<\\/code>, <code>)<\\/code> oder <code>}<\\/code> zu schließen.\\n\",\"and\":\"und\",\"or\":\"oder\",\"listcomma\":\", \",\"oxfordcomma\":\",\"}}},\"ko\":{\"translation\":{\"button\":{\"runcode\":\"코드 실행\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"힌트\",\"hint_plural\":\"힌트들\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"다음 힌트\",\"hintprev\":\"이전 힌트\",\"solution\":\"솔루션\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"클립보드에 복사\",\"startover\":\"재학습\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"다음 학습으로\",\"submitanswer\":\"정답 제출\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"이전 토픽\",\"nexttopic\":\"다음 토픽\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"재시도\"},\"text\":{\"startover\":\"재학습\",\"areyousure\":\"다시 시작 하시겠습니까? (모든 예제의 진행 정보가 재설정됩니다)\",\"youmustcomplete\":\"당신은 완료해야 합니다\",\"exercise\":\"연습문제\",\"exercise_plural\":\"연습문제들\",\"inthissection\":\"이 섹션을 실행하기 전에\",\"code\":\"코드\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"퀴즈\",\"blank\":\"공백\",\"blank_plural\":\"공백들\",\"exercisecontainsblank\":\"이 연습문제에는 {{count}}개의 $t(text.blank)이 포함되어 있습니다.\",\"pleasereplaceblank\":\"{{blank}}를 유효한 코드로 바꾸십시오.\",\"unparsable\":\"이것은 유효한 R 코드가 아닐 수 있습니다. R은 텍스트를 완전한 명령으로 변환하는 방법을 결정할 수 없습니다. 당신은 공백이나 밑줄을 대체하여 채우기, 인수를 컴마로 구분하기, 또는 <code>&quot;<\\/code>, <code>'<\\/code>, <code>(<\\/code> , <code>{<\\/code>로 시작하는 구문을 닫는 <code>&quot;<\\/code>, <code>'<\\/code>, <code>)<\\/code>, <code>}<\\/code>을 잊었을 수도 있습니다.\\n\",\"and\":\"그리고\",\"or\":\"혹은\",\"listcomma\":\", \",\"oxfordcomma\":\"\"}}},\"zh\":{\"translation\":{\"button\":{\"runcode\":\"运行代码\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"提示\",\"hint_plural\":\"提示\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"下一个提示\",\"hintprev\":\"上一个提示\",\"solution\":\"答案\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"复制到剪切板\",\"startover\":\"重新开始\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"继续\",\"submitanswer\":\"提交答案\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"上一专题\",\"nexttopic\":\"下一专题\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"再试一次\"},\"text\":{\"startover\":\"重置\",\"areyousure\":\"你确定要重新开始吗? (所有当前进度将被重置)\",\"youmustcomplete\":\"你必须完成\",\"exercise\":\"练习\",\"exercise_plural\":\"练习\",\"inthissection\":\"在进行本节之前\",\"code\":\"代码\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"测试\",\"blank\":\"空\",\"blank_plural\":\"空\",\"exercisecontainsblank\":\"本练习包含{{count}}个$t(text.blank)\",\"pleasereplaceblank\":\"请在{{blank}}内填写恰当的代码\",\"unparsable\":\"这似乎不是有效的R代码。 R不知道如何将您的文本转换为完整的命令。 您是否忘了填空，忘了删除下划线，忘了在参数之间包含逗号，或者是忘了用<code>&quot;<\\/code>, <code>'<\\/code>, <code>)<\\/code>,<code>}<\\/code>来封闭<code>&quot;<\\/code>, <code>'<\\/code>, <code>(<\\/code>。 or <code>{<\\/code>。\\n\",\"unparsablequotes\":\"<p>您的R代码中似乎含有特殊格式的引号，或者弯引号(<code>{{character}}<\\/code>) 在字符串前后，在R中字符串应该被直引号(<code>&quot;<\\/code> 或者 <code>'<\\/code>)包裹。<\\/p> {{code}} <p>别担心，该错误经常在复制粘贴包含格式的代码时遇到， 您可以尝试将该行中的代码替换为以下代码，也许还有其他地方需要修改。<\\/p> {{suggestion}}\\n\",\"unparsableunicode\":\"<p>您的代码中似乎包含有异常字符(<code>{{character}}<\\/code>),导致代码无效。<\\/p> {{code}} <p>有时候你的代码可能含有看似正常字符的特殊字符，特别是当你复制粘贴其他来源代码的时候。 请试着删除这些特殊字符,重新输入<\\/p>\\n\",\"unparsableunicodesuggestion\":\"<p>您的代码中似乎包含有异常字符(<code>{{character}}<\\/code>),导致代码无效。<\\/p> {{code}} <p>有时候你的代码可能含有看似正常字符的特殊字符，特别是当你复制粘贴其他来源代码的时候。 请试着删除这些特殊字符,重新输入<\\/p>\\n\",\"and\":\"且\",\"or\":\"或\",\"listcomma\":\",\",\"oxfordcomma\":\",\"}}},\"pl\":{\"translation\":{\"button\":{\"runcode\":\"Uruchom kod\",\"runcodetitle\":\"$t(button.runcode) ({{kbd}})\",\"hint\":\"Podpowiedź\",\"hint_plural\":\"Podpowiedzi\",\"hinttitle\":\"$t(button.hint)\",\"hintnext\":\"Następna podpowiedź\",\"hintprev\":\"Poprzednia podpowiedź\",\"solution\":\"Rozwiązanie\",\"solutiontitle\":\"$t(button.solution)\",\"copyclipboard\":\"Kopiuj do schowka\",\"startover\":\"Zacznij od początku\",\"startovertitle\":\"$t(button.startover)\",\"continue\":\"Kontynuuj\",\"submitanswer\":\"Wyślij\",\"submitanswertitle\":\"$t(button.submitanswer)\",\"previoustopic\":\"Poprzednia sekcja\",\"nexttopic\":\"Następna sekcja\",\"questionsubmit\":\"$t(button.submitanswer)\",\"questiontryagain\":\"Spróbuj ponownie\"},\"text\":{\"startover\":\"Zacznij od początku\",\"areyousure\":\"Czy na pewno chcesz zacząć od początku? (cały postęp w zadaniu zostanie utracony)\",\"youmustcomplete\":\"Musisz ukończyć\",\"exercise\":\"ćwiczenie\",\"exercise_plural\":\"ćwiczenia\",\"inthissection\":\"w tej sekcji przed kontynuowaniem\",\"code\":\"Kod\",\"enginecap\":\"$t(text.code) {{engine}}\",\"quiz\":\"Quiz\",\"blank\":\"luka\",\"blank_plural\":\"luk(i)\",\"exercisecontainsblank\":\"To ćwiczenie zawiera {{count}} $t(text.blank).\",\"pleasereplaceblank\":\"Proszę uzupełnić {{blank}} prawidłowym kodem.\",\"unparsable\":\"Wygląda na to, że może to nie być prawidłowy kod R. R nie jest w stanie przetworzyć Twojego tekstu na polecenie. Mogłeś(-aś) zapomnieć wypełnić luki, usunąć podkreślnik, umieścić przecinka między argumentami, lub zamknąć znak <code>&quot;<\\/code>, <code>'<\\/code>, <code>(<\\/code> lub <code>{<\\/code> odpowiadającym <code>&quot;<\\/code>, <code>'<\\/code>, <code>)<\\/code> lub <code>}<\\/code>.\\n\",\"unparsablequotes\":\"<p>Wygląda na to, że Twój kod zawiera szczególnie sformatowane cudzysłowy lub cudzysłowy typograficzne (<code>{{character}}<\\/code>) przy ciągach znaków, co sprawia, że kod jest niepoprawny. R wymaga cudzysłowów prostych (<code>&quot;<\\/code> albo <code>'<\\/code>).<\\/p> {{code}} <p>Nie martw się, to powszechne źródło błędów, gdy kopiuje się kod z innego programu, który sam formatuje teskt. Możesz spróbować zastąpić swój kod następującym kodem. Mogą być też inne miejsca, które wymagają poprawienia.<\\/p> {{suggestion}}\\n\",\"unparsableunicode\":\"<p>Wygląda na to, że Twój kod zawiera niespodziewany znak specjalny (<code>{{character}}<\\/code>), co sprawia, że kod jest niepoprawny.<\\/p> {{code}} <p>Czasami Twój kod może zawierać znak specjalny, który wygląda jak zwykły znak, zwłaszcza jeśli kopiujesz kod z innego programu. Spróbuj usunąć znak specjalny i wpisać do ponownie ręcznie.<\\/p>\\n\",\"unparsableunicodesuggestion\":\"<p>Wygląda na to, że Twój kod zawiera niespodziewany znak specjalny (<code>{{character}}<\\/code>), co sprawia, że kod jest niepoprawny.<\\/p> {{code}} <p>Czasami Twój kod może zawierać znak specjalny, który wygląda jak zwykły znak, zwłaszcza jeśli kopiujesz kod z innego programu. Możesz spróbować zastąpić swój kod następującym kodem. Mogą być też inne miejsca, które wymagają poprawienia.<\\/p> {{suggestion}}\\n\",\"and\":\"i\",\"or\":\"lub\",\"listcomma\":\", \",\"oxfordcomma\":\"\"}}}}}<\/script>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.11.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css","rstudio-theme.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.24"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.24"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/3.6.0"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery-3.6.0.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquerylib"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.1.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["6.4.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.min.css","css/v4-shims.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["fontawesome"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.5.2"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["5.5.2"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.11.4"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["2.0.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.11.4"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73]}},"value":[{"type":"character","attributes":{},"value":["backports","base","bbmle","bdsmatrix","bslib","cachem","checkmate","cli","coda","compiler","datasets","digest","dplyr","ellipsis","emdbook","evaluate","fansi","fastmap","fontawesome","generics","glue","gradethis","graphics","grDevices","grid","HDInterval","highr","htmltools","htmlwidgets","httpuv","jagsUI","jquerylib","jsonlite","knitr","later","lattice","learnr","lifecycle","loo","magrittr","MASS","Matrix","matrixStats","methods","mime","mvtnorm","numDeriv","parallel","pillar","pkgconfig","plyr","promises","R6","Rcpp","rjags","rlang","rmarkdown","rprojroot","rstudioapi","sass","shiny","stats","stats4","tibble","tidyselect","tools","utf8","utils","vctrs","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.4.1","4.3.1","1.0.25","1.3-6","0.5.1","1.0.8","2.2.0","3.6.1","0.19-4","4.3.1","4.3.1","0.6.33","1.1.2","0.3.2","1.3.13","0.21","1.0.4","1.1.1","0.5.2","0.1.3","1.6.2","0.2.14","4.3.1","4.3.1","4.3.1","0.2.4","0.10","0.5.6","1.6.2","1.6.11","1.5.2","0.1.4","1.8.7","1.43","1.3.1","0.21-8","0.11.4","1.0.3","2.6.0","2.0.3","7.3-60","1.6-1","1.0.0","4.3.1","0.12","1.2-2","2016.8-1.1","4.3.1","1.9.0","2.0.3","1.8.8","1.2.1","2.5.1","1.0.11","4-14","1.1.1","2.24","2.0.3","0.15.0","0.4.7","1.7.5","4.3.1","4.3.1","3.2.1","1.2.0","4.3.1","1.2.3","4.3.1","0.6.3","2.5.0","0.40","1.8-4","2.3.7"]}]}]}
</script>
<!--/html_preserve-->
</div>

</article> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h1 class="title toc-ignore" style="display:none;">Lab 4</h1>
<h4 class="author"><em>NRES 746</em></h4>
<h4 class="date"><em>Fall 2023</em></h4>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</main> <!-- bandContent page -->
</div> <!-- pageContent band -->



<!-- Build Tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</body>

</html>
